# 多项式计算

计算多项式
$$
P(x) = 2x^4 + 3x^3 - 3x^2 + 5x-1
$$
在$x = 1/2$处最好的方法是什么？我们假设多项式的系数和数字$1/2$都存储在内存中，我们尽量去减少计算的加法和乘法。我们不考虑从内存中取值所耗费的时间。

**方法一**  首先最直接的方法是
$$
P(\frac{1}{2}) = 2*\frac{1}{2}*\frac{1}{2}*\frac{1}{2}*\frac{1}{2} + 3*\frac{1}{2}*\frac{1}{2}*\frac{1}{2} - 3*\frac{1}{2}*\frac{1}{2} + 5*\frac{1}{2} - 1 = \frac{5}{4}
$$
此方法共执行乘法$10$次，加法$4$次。很显然，有比此方法更简单的方法。

**方法二** 首先先计算$x = 1/2$的幂，存储后使用
$$
\begin{aligned}
\frac{1}{2}*\frac{1}{2} &= (\frac{1}{2})^2\\
(\frac{1}{2})^2*\frac{1}{2} &= (\frac{1}{2})^3\\
(\frac{1}{2})^3*\frac{1}{2} &= (\frac{1}{2})^4
\end{aligned}
$$
然后，我们将这些项加起来：
$$
P(\frac{1}{2}) = 2*(\frac{1}{2})^4 + 3*(\frac{1}{2})^3 - 3*(\frac{1}{2})^2 + 5*\frac{1}{2} - 1 = \frac{5}{4}
$$
我们执行了$7$次乘法和$4$次加法。虽然相比上个方法执行运算的次数减少了，但是还有更好的方法。  

**方法三** 嵌套乘法
$$
\begin{aligned}
P(x) &=-1+x\left(2 x^{3}+3 x^{2}-3 x+5\right) \\
&=-1+x\left(5+x\left(2 x^{2}+3 x-3\right)\right) \\
&=-1+x(5+x(-3+x(2 x+3)))
\end{aligned}
$$
这套方法被称为嵌套法或霍纳法。一个$d$次多项式需要计算$d$次加法和$d$次乘法。

当多项式的标准格式为$c_1 + c_2x + c_3x^2 + c_4x^3 + c_5x^4$，可以被写为嵌套形式：
$$
c_1 + x(c_2 + x(c_3+x(c_4+x(c_5))))
$$
  一些应用需要更一般的形式。特别的，插值计算需要以下形式：
$$
c_1 + (x-r_1)(c_2+(x-r_2)(c_3+(x-r_3)(c_4+(x-r_4)(c_5))))
$$
其中$r_1,r_2,r_3,r_4$为基点。

代码实现

~~~matlab
function y = Nest(d, c, x, b)
if nargin < 4
	b = zeros(d, 1);
end
y = c(d+1);
for i = d:-1:1
	y = y.*(x-b(i)) + c(i);
end
~~~

